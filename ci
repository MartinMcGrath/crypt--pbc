#!/bin/bash
# vi:syntax=gentoo-init-d:

source /sbin/functions.sh
set -e; trap "eend 997" ERR

ebegin "checking MANIFEST";
./distclean
eend $?

ebegin "pulling/merging updates"
cg update
eend $?

ebegin "updating update index (cache)"
(git-update-index --refresh >/dev/null)
einfo "(updated)";
eend $?

ebegin "committing changes"
cg commit -m "$0"
eend $?

ebegin "pushing commit to repo"
cg push
eend $?
